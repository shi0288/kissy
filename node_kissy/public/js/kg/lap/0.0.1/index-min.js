KISSY.add('kg/lap/0.0.1/index',["event"],function(S ,require, exports, module) {function t(){var t=S.makeArray(arguments);S.each(t.shift(),function(n){n.apply(null,t)})}function n(t,n){var s=this,a=S.merge(e,n);s.handleData=[].concat(t),s.cfg=a,s.doIndex=-1,s.fnHandlers=[],s.fnBatches=[],s.fnCallbacks=[],s.duration=a.duration||300,s.delay=a.delay||30,s.isPause=!1,s.isStop=!1}var s=require("event"),e={duration:300,delay:100},a=[];S.augment(n,s.Target,{handle:function(t){this.fnHandlers.push(t)},batch:function(t){this.fnBatches.push(t)},then:function(t){this.fnCallbacks.push(t)},start:function(){var t=this;if(t.isStop)throw new Error("the task has complete.");t.isPause=!1,setTimeout(function(){t._process()},0)},process:function(){S.later(this._process,0)},pause:function(){this.isPause=!0},stop:function(){this.isStop||this._stop()},_stop:function(){this.isStop=!0,t(this.fnCallbacks)},_process:function(){var n=this,s=n.handleData,e=n.fnHandlers;if(!(n.isStop||n.isPause&&s.length>0)){var a=+new Date+n.duration,i=-1;do{var o=s.shift();void 0!==o&&(n.doIndex++,i++,t(e,o,n.doIndex,i))}while(s.length>0&&a>+new Date&&!n.isPause&&!n.isStop);t(n.fnBatches,n.doIndex),0!=s.length||n.isStop?setTimeout(function(){n._process()},n.delay):n._stop()}}}),module.exports=function(t,s){var e=new n(t,s);return a.push(e),e};});