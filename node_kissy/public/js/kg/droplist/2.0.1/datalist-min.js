/*!build time : 2014-09-26 4:21:54 PM*/
KISSY.add("kg/droplist/2.0.1/datalist",function(a,b,c,d){function e(){this._init.apply(this,arguments)}var f="__id",g="__index",h={dataSource:null};a.augment(e,a.EventTarget,{_init:function(b){b=this.cfg=a.merge(h,b),this.cache={},this._dataMap={},this._initSelected=b.selected,this.mulSelect=b.mulSelect},getDataByValue:function(b){if(this.getDataSource()){var c;return a.each(this.getDataSource(),function(a){return a.value===b?(c=a,!1):void 0}),c}},getClientId:function(a){return a&&a[f]},getDataByText:function(b){if(this.getDataSource()){var c;return a.each(this.getDataSource(),function(a){return a.text===b?(c=a,!1):void 0}),c}},select:function(b){var c=b;a.isPlainObject(b)||void 0==b||(c=this._dataMap[b]),this._selectByData(c)},_selectByData:function(b){if(this.mulSelect){if(this.selected&&b&&a.inArray(b,this.selected))return}else if(this.selected&&b&&b.value===this.selected.value)return;this.fire("selected",{data:b})},saveData:function(a){this.mulSelect?(this.selected=this.selected||[],this.selected.push(a)):this.selected=a},delData:function(a){for(var b=0;b<this.selected.length;b++)if(this.selected[b].__id==a){this.selected.splice(b,1);break}},getSelectedData:function(){return this.selected||this._initSelected},setDataSource:function(a,b){this.cache[a]=b,this._list=b},getDataSource:function(a){return a=a||"",this.cache[a]},dataFactory:function(b){var c=this,d=c.getSelectedData(),e=[],h=this._dataMap;return c.selected=void 0,a.each(b,function(b,i){var j=a.guid();if(b[f]=j,b[g]=i,h[j]=b,e.push(b),c.cfg.mulSelect){if(d&&d.length)for(var k=0;k<d.length;k++)if(d[k]&&b.value==d[k].value){c.select(j);break}}else d&&b.value==d.value&&c.select(j)}),delete c._initSelected,e}}),d.exports=e});